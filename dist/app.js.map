{"version":3,"sources":["../lib/app.ts"],"names":[],"mappings":"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","file":"app.js","sourceRoot":"","sourcesContent":["import { NgModule, NgZone, ModuleWithProviders, OpaqueToken, Inject, Optional } from '@angular/core';\r\nimport { LIB_KEY, LIB_KEY_SEPARATOR, LIB_KEY_CASE_SENSITIVE } from './constants/lib';\r\nimport { STORAGE } from './enums/storage';\r\nimport { LocalStorageService, SessionStorageService } from './services/index';\r\nimport { WebStorageHelper } from './helpers/webStorage';\r\nimport { WebstorageConfig, IWebstorageConfig } from './interfaces/config';\r\nimport { KeyStorageHelper } from './helpers/keyStorage';\r\n\r\nexport * from './interfaces/index';\r\nexport * from './decorators/index';\r\nexport * from './services/index';\r\n\r\nexport const WEBSTORAGE_CONFIG = new OpaqueToken('WEBSTORAGE_CONFIG');\r\n\r\n\r\nexport class Ng2Webstorage {\r\n  static forRoot(config?: IWebstorageConfig): ModuleWithProviders {\r\n    return {\r\n      ngModule: Ng2Webstorage,\r\n      providers: [\r\n        {\r\n          provide: WEBSTORAGE_CONFIG,\r\n          useValue: config\r\n        },\r\n        {\r\n          provide: WebstorageConfig,\r\n          useFactory: provideConfig,\r\n          deps: [WEBSTORAGE_CONFIG]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n\r\n  constructor(\r\n    private ngZone: NgZone,\r\n    \r\n    \r\n    config: WebstorageConfig\r\n  ) {\r\n    if (config) {\r\n      KeyStorageHelper.setStorageKeyPrefix(config.prefix);\r\n      KeyStorageHelper.setStorageKeySeparator(config.separator);\r\n      KeyStorageHelper.setCaseSensitivity(config.caseSensitive);\r\n    }\r\n\r\n    this.initStorageListener();\r\n  }\r\n\r\n  private initStorageListener() {\r\n    if (typeof window !== 'undefined') {\r\n      window.addEventListener('storage', (event: StorageEvent) =>\r\n        this.ngZone.run(() => {\r\n          let storage: STORAGE = window.sessionStorage === event.storageArea ? STORAGE.session : STORAGE.local;\r\n          setTimeout(function() {\r\n            WebStorageHelper.refresh(storage, event.key);\r\n          });\r\n        })\r\n      );\r\n    }\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\r\n  declarations: [],\r\n  providers: [SessionStorageService, LocalStorageService],\r\n  imports: []\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: NgZone, },\n{type: WebstorageConfig, decorators: [{ type: Optional }, { type: Inject, args: [WebstorageConfig, ] }, ]},\n];\n}\r\n\r\nexport function provideConfig(config: IWebstorageConfig): WebstorageConfig {\r\n  return new WebstorageConfig(config);\r\n}\r\n\r\nexport function configure(\r\n  { prefix, separator, caseSensitive }: IWebstorageConfig = {\r\n    caseSensitive: LIB_KEY_CASE_SENSITIVE,\r\n    prefix: LIB_KEY,\r\n    separator: LIB_KEY_SEPARATOR\r\n  }\r\n) {\r\n  /*@Deprecation*/\r\n  console.warn('[ng2-webstorage:deprecation] The configure method is deprecated since the v1.5.0, consider to use forRoot instead');\r\n\r\n  KeyStorageHelper.setStorageKeyPrefix(prefix);\r\n  KeyStorageHelper.setStorageKeySeparator(separator);\r\n  KeyStorageHelper.setCaseSensitivity(caseSensitive);\r\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}